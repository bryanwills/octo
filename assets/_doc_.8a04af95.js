import{E as d}from"./Editor.3fa99236.js";import{_ as r,i as n,r as c,o as p,d as l,a7 as i,a8 as h,a9 as u,aa as m,ab as f,ac as y,ad as $}from"./index.b8eb6ee5.js";import"./account.39fe3759.js";import"./transform.812ac62b.js";const s=(t,e=", ")=>t.map(a=>`#${a}`).join(e),g=n({components:{Editor:d},props:{docId:String,initialFocus:{type:String,default:()=>"any",validator:t=>["any","start","end"].includes(t)},initialSelections:{type:Array},readonly:{type:Boolean}},data(){return{editor:null,placeholder:new i({text:s(this.$store.state.context.tags," ")})}},watch:{tags:{deep:!0,handler(){this.updateTitle()}},header(){this.updateTitle()}},computed:{appearance(){return this.$store.state.settings.theme==="october"?"dark":this.$store.state.settings.theme},doc(){return this.$store.getters.decrypted.find(t=>t.id===this.docId)||this.placeholder},settings(){return this.$store.state.settings.editor},tags(){return this.doc.tags},header(){return this.doc.headers[0]}},methods:{input(t){this.readonly||(this.docId?this.$store.commit(h,{id:this.doc.id,text:t}):(this.$store.commit(u,new i({id:this.doc.id,text:t})),this.$router.replace({path:`/docs/${this.doc.id}`,query:{p:!0}})))},async findSharedDocument(){const t=await m({docId:this.$route.params.docId}),e=t.data(),a={...e,id:e.id||e.clientId,firebaseId:t.id,textKey:e.textKey||e.dataKey,createdAt:e.createdAt?e.createdAt.toDate():null,discardedAt:e.discardedAt?e.discardedAt.toDate():null,updatedAt:e.updatedAt?e.updatedAt.toDate():null,touchedAt:e.touchedAt?e.touchedAt.toDate():null,syncedAt:e.syncedAt.toDate()};return f(a,{privateKey:this.$store.state.settings.crypto.privateKey})},updateTitle(){y(this.header||s(this.doc.tags))}},beforeRouteUpdate(t,e,a){t.name==="docs-doc"&&this.$store.dispatch($,{id:t.params.docId}),a()},async mounted(){this.updateTitle(),this.readonly&&(this.placeholder=await this.findSharedDocument())}});function A(t,e,a,D,E,I){const o=c("Editor");return p(),l(o,{ref:"editable",appearance:t.appearance,doc:t.doc,initialFocus:t.initialFocus,initialSelections:t.initialSelections,readonly:t.readonly,settings:t.settings,onInput:t.input},null,8,["appearance","doc","initialFocus","initialSelections","readonly","settings","onInput"])}var b=r(g,[["render",A]]);export{b as default};
