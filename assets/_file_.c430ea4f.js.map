{"version":3,"file":"_file_.c430ea4f.js","sources":["../../pages/file-editor/[file].vue"],"sourcesContent":["<template>\n  <Editor :appearance=\"appearance\" :settings=\"settings\" :doc=\"doc\" @input=\"input\" />\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, ref, watchEffect } from 'vue'\nimport { useStore } from 'vuex'\n\nimport Doc from '/src/models/doc'\nimport Debouncer from '/src/common/debouncer'\nimport Editor from '/components/Editor.vue'\nimport { useFiles } from '/src/stores/files'\n\nconst { id } = defineProps({ id: String })\nconst fileStore = useFiles()\nconst store = useStore()\nconst debouncer = new Debouncer(800)\nconst appearance = computed(() => {\n  if (store.state.settings.theme === 'october') { return 'dark' }\n\n  return store.state.settings.theme as string\n})\nconst settings = computed(() => {\n  return store.state.settings.editor\n})\n\nconst doc = ref(new Doc())\nconst file = computed(() => (fileStore.files.find(file => file.id === id)))\n\nwatchEffect(async () => {\n  if (file?.value) {\n    // @ts-ignore\n    await file.value.handle.createWritable()\n    const fileHandle = await file.value.handle.getFile()\n\n    if (fileHandle) {\n      doc.value.update({ text: await fileHandle.text() })\n    }\n  }\n})\n\nconst input = async (text: string) => {\n  // @ts-ignore\n  debouncer.debounce(file.value.id, async () => {\n    // @ts-ignore\n    const writable = await file.value.handle.createWritable()\n    writable.write(text)\n    writable.close()\n  })\n}\n</script>\n"],"names":["file"],"mappings":";;;;;;;;;;AAcA,UAAM,YAAY;AAClB,UAAM,QAAQ;AACR,UAAA,YAAY,IAAI,UAAU,GAAG;AAC7B,UAAA,aAAa,SAAS,MAAM;AAChC,UAAI,MAAM,MAAM,SAAS,UAAU,WAAW;AAAS,eAAA;AAAA,MAAO;AAEvD,aAAA,MAAM,MAAM,SAAS;AAAA,IAAA,CAC7B;AACK,UAAA,WAAW,SAAS,MAAM;AACvB,aAAA,MAAM,MAAM,SAAS;AAAA,IAAA,CAC7B;AAED,UAAM,MAAM,IAAI,IAAI,IAAK,CAAA;AACnB,UAAA,OAAO,SAAS,MAAO,UAAU,MAAM,KAAK,CAAAA,UAAQA,MAAK,OAAO,EAAE,CAAE;AAE1E,gBAAY,YAAY;AACtB,UAAI,6BAAM,OAAO;AAET,cAAA,KAAK,MAAM,OAAO,eAAe;AACvC,cAAM,aAAa,MAAM,KAAK,MAAM,OAAO,QAAQ;AAEnD,YAAI,YAAY;AACV,cAAA,MAAM,OAAO,EAAE,MAAM,MAAM,WAAW,QAAQ;AAAA,QACpD;AAAA,MACF;AAAA,IAAA,CACD;AAEK,UAAA,QAAQ,OAAO,SAAiB;AAEpC,gBAAU,SAAS,KAAK,MAAM,IAAI,YAAY;AAE5C,cAAM,WAAW,MAAM,KAAK,MAAM,OAAO,eAAe;AACxD,iBAAS,MAAM,IAAI;AACnB,iBAAS,MAAM;AAAA,MAAA,CAChB;AAAA,IAAA;;;;;;;;;;;"}