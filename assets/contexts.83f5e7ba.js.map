{"version":3,"file":"contexts.83f5e7ba.js","sources":["../../pages/contexts.vue"],"sourcesContent":["<template>\n  <div class=\"container flex flex-col mx-auto p-4 md:px-16 md:py-8\">\n    <div>\n      <h2 class=\"text-2xl\">Context Switching</h2>\n      <p class=\"mt-1 text-gray-500\">\n        A context allows you to focus on what's important now by filtering your docs down to just a handful of relevant tags.\n      </p>\n      <div class=\"mt-4\">\n        <label for=\"context-name\">Name it and save it (optional)</label>\n        <div class=\"flex items-center mt-2\">\n          <input v-model=\"contextName\" type=\"text\" class=\"form-text w-full shadow\" id=\"context-name\" placeholder=\"Give this context a name...\">\n          <button @click=\"save\" :disabled=\"!(tags.length && contextName)\" class=\"button button-size-medium button-color-gray disabled:text-gray-900 ml-2\">Save</button>\n        </div>\n        <small class=\"text-gray-700 mt-1 hidden md:block\">You must add at least one tag and give the context a name in order to save it.</small>\n      </div>\n      <div class=\"mt-4\">\n        <label for=\"tags-search\">Choose some tags</label>\n        <input v-model=\"input\" @input=\"first\" @keydown.space.prevent=\"toggleTag\" @keydown.enter.exact=\"toggleTag\" @keydown.221.prevent=\"down\" @keydown.down.prevent=\"down\" @keydown.219.prevent=\"up\" @keydown.up.prevent=\"up\" ref=\"input\" type=\"text\" class=\"form-text w-full mt-2\" id=\"tag-search\" placeholder=\"Start typing to filter the list...\" autocomplete=\"off\">\n        <small class=\"text-gray-700 mt-1 hidden md:block\">Navigate the list below with <span class=\"key\">up</span> or <span class=\"key\">down</span> and toggle tags with <span class=\"key\">space</span> or <span class=\"key\">enter</span></small>\n      </div>\n      <SimpleBar ref=\"tagsContainer\" class=\"border rounded mt-4 overflow-hidden bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-700\">\n        <div>\n          <div v-if=\"filtered.length\">\n            <div v-for=\"(tag, index) in filtered\" @click=\"selectTag(tag)\" :key=\"tag\" ref=\"tags\" class=\"flex justify-between cursor-pointer p-6 md:p-3 focus-within:ring\" :class=\"{ 'bg-gray-200 dark:bg-gray-700': isSelected(tag), 'bg-blue-300 dark:bg-blue-500': (index === activeIndex) }\">\n              <Tag>{{ tag }}</Tag>\n              <span v-if=\"isSelected(tag)\">selected</span>\n            </div>\n          </div>\n          <div v-else class=\"flex justify-between p-3\">No results...</div>\n        </div>\n      </SimpleBar>\n      <div class=\"mt-4\">\n        <h3 class=\"text-xl mb-4\">Saved Contexts</h3>\n        <div class=\"grid gap-4 grid-cols-1 lg:grid-cols-2\">\n          <div v-for=\"context in contexts\" :key=\"context.id\" class=\"shadow relative flex flex-col min-w-0 rounded p-4 bg-gray-100 dark:bg-gray-800 dark:text-gray-300\">\n            <div class=\"flex items-center justify-between mb-4\">\n              <h4 class=\"text-lg flex items-center\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\n                </svg>\n                <span class=\"ml-2\">{{ context.name }}</span>\n              </h4>\n              <button @click=\"discard(context)\" class=\"button-flat button-size-medium text-sm text-red-500 bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700\">\n                <svg height=\"1.25em\" width=\"1.25em\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                </svg>\n                <span class=\"ml-2\">Discard</span>\n              </button>\n            </div>\n            <div class=\"flex items-center flex-wrap\">\n              <Tag v-for=\"tag in context.tags\" :key=\"tag\" class=\"mr-6\">{{ tag }}</Tag>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { nanoid } from 'nanoid'\n\nimport Tag from '/components/Tag.vue'\n\nimport {\n  SET_CONTEXT_TAGS,\n} from '/src/store/actions.js';\n\nimport {\n  ADD_CONTEXT,\n  REMOVE_CONTEXT,\n} from '/src/store/modules/contexts.js'\n\nexport default {\n  components: {\n    Tag,\n  },\n  data() {\n    return {\n      activeIndex: 0,\n      contextName: '',\n      input: '',\n    };\n  },\n  computed: {\n    availableTags() {\n      return this.$store.getters.allTags;\n    },\n    contexts() {\n      return this.$store.getters.sortedContexts\n    },\n    filtered() {\n      return this.availableTags.filter((tag) => {\n        return tag.startsWith(this.input.toLowerCase());\n      });\n    },\n    selected() {\n      return this.tags.sort();\n    },\n    tags() {\n      return this.$store.state.context.tags;\n    },\n  },\n  methods: {\n    discard(context) {\n      this.$store.commit(REMOVE_CONTEXT, context)\n    },\n    down() {\n      if (this.activeIndex < (this.filtered.length - 1)) {\n        this.activeIndex += 1;\n\n        this.scroll();\n      }\n    },\n    first() {\n      this.activeIndex = 0;\n\n      this.$refs.tagsContainer.scrollElement.scroll(0, 0);\n    },\n    focusInput() {\n      this.$refs.input.focus();\n    },\n    save() {\n      this.$store.commit(ADD_CONTEXT, {\n        id: nanoid(),\n        name: this.contextName,\n        tags: this.tags,\n      })\n\n      this.contextName = ''\n      this.$store.dispatch(SET_CONTEXT_TAGS, { context: { tags: [] } })\n    },\n    scroll() {\n      const tagsContainer = this.$refs.tagsContainer.scrollElement;\n      const tag = this.$refs.tags[this.activeIndex];\n\n      const scrolltop = tagsContainer.scrollTop;\n      const offsetheight = tagsContainer.offsetHeight;\n      const offsettop = tag.offsetTop;\n      const height = tag.offsetHeight;\n\n      if (((offsettop + height) - scrolltop) > offsetheight) {\n        // need to scroll down\n        const scrolloffset = (offsettop - offsetheight) + height;\n\n        tagsContainer.scroll(0, scrolloffset);\n      } else if (offsettop < scrolltop) {\n        // need to scroll up?\n        tagsContainer.scroll(0, offsettop);\n      }\n    },\n    selectTag(tag) {\n      this.activeIndex = this.filtered.findIndex(t => t === tag);\n\n      this.toggleTag();\n      this.focusInput();\n      this.scroll();\n    },\n    isSelected(tag) {\n      return this.tags.includes(tag);\n    },\n    toggleTag() {\n      const tag = this.filtered[this.activeIndex];\n\n      if (tag) {\n        let tags = this.tags;\n\n        if (tags.includes(tag)) {\n          tags = tags.filter(t => t !== tag);\n        } else {\n          tags = tags.concat([tag]);\n        }\n\n        this.$store.dispatch(SET_CONTEXT_TAGS, {\n          context: {\n            tags,\n          }\n        });\n      }\n    },\n    up() {\n      if (this.activeIndex > 0) {\n        this.activeIndex -= 1;\n\n        this.scroll();\n      }\n    },\n  },\n  mounted() {\n    // todo use action\n    this.$store.state.context.editing = true;\n    this.focusInput();\n  },\n  beforeUnmount() {\n    this.$store.state.context.editing = false;\n  },\n};\n</script>\n\n<style scoped>\n.dropdown-menu {\n  float: none;\n  max-height: 20rem;\n  padding: 0;\n  position: relative;\n  z-index: auto;\n}\n\n.dropdown-item {\n  cursor: pointer;\n}\n\n.dropdown-item.selected:not(.active) {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n\n.dropdown-item:hover:not(.active) {\n  background-color: #3f3f3f;\n}\n\n.form-control {\n  border: none;\n  height: auto;\n}\n\n.key {\n  border: 1px solid;\n  border-radius: 0.125rem;\n  padding: 0 0.25rem;\n  text-transform: uppercase;\n}\n\n.label {\n  background-color: #557bab;\n  border: none;\n  padding: 0.25rem 0.75rem;\n}\n</style>\n"],"names":["Tag","_createElementVNode","_openBlock","_createElementBlock","_createVNode","_Fragment","_renderList","_normalizeClass","_toDisplayString","_createBlock"],"mappings":"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"}