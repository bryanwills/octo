{"version":3,"file":"workspaces.bd9abe52.js","sources":["../../pages/workspaces.vue"],"sourcesContent":["<template>\n  <div class=\"container flex flex-col mx-auto p-4 md:px-16 md:py-8\">\n    <div>\n      <h2 class=\"text-2xl\">Workspaces</h2>\n      <p class=\"mt-1 text-gray-500\">\n        A Workspace allows you to focus on what's important now by filtering your docs down to just a handful of relevant tags.\n      </p>\n      <div class=\"mt-4\">\n        <label for=\"context-name\">Name it and save it (optional)</label>\n        <div class=\"flex items-center mt-2\">\n          <input v-model=\"contextName\" type=\"text\" class=\"form-text w-full shadow\" id=\"context-name\" placeholder=\"Give this Workspace a name...\">\n          <button @click=\"save\" :disabled=\"!(tags.length && contextName)\" class=\"button button-size-medium button-color-gray disabled:text-gray-900 ml-2\">Save</button>\n        </div>\n        <small class=\"text-gray-700 mt-1 hidden md:block\">You must add at least one tag and give the context a name in order to save it.</small>\n      </div>\n      <div class=\"mt-4\">\n        <label for=\"tags-search\">Choose some tags</label>\n        <input v-model=\"input\" @input=\"first\" @keydown.space.prevent=\"toggleTag\" @keydown.enter.exact=\"toggleTag\" @keydown.221.prevent=\"down\" @keydown.down.prevent=\"down\" @keydown.219.prevent=\"up\" @keydown.up.prevent=\"up\" ref=\"input\" type=\"text\" class=\"form-text w-full mt-2\" id=\"tag-search\" placeholder=\"Start typing to filter the list...\" autocomplete=\"off\">\n        <small class=\"text-gray-700 mt-1 hidden md:block\">Navigate the list below with <span class=\"key\">up</span> or <span class=\"key\">down</span> and toggle tags with <span class=\"key\">space</span> or <span class=\"key\">enter</span></small>\n      </div>\n      <CoreScrollable ref=\"tagsContainer\" class=\"border rounded mt-4 max-h-[20rem] bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-700\">\n        <div>\n          <div v-if=\"filtered.length\" class=\"flex flex-col gap-1 p-2\">\n            <CoreButton v-for=\"(tag, index) in filtered\" @click=\"selectTag(tag)\" :key=\"tag\" ref=\"tags\" class=\"flex justify-between cursor-pointer p-6 md:p-3 focus-within:ring\" :class=\"{ 'bg-gray-200 dark:bg-gray-700': isSelected(tag), 'bg-blue-300 dark:bg-blue-500': (index === activeIndex) }\">\n              <Tag>{{ tag }}</Tag>\n              <span v-if=\"isSelected(tag)\">selected</span>\n            </CoreButton>\n          </div>\n          <div v-else class=\"flex justify-between p-3\">No results...</div>\n        </div>\n      </CoreScrollable>\n      <div class=\"mt-4\">\n        <h3 class=\"text-xl mb-4\">Workspaces</h3>\n        <div class=\"grid gap-4 grid-cols-1 lg:grid-cols-2\">\n          <div v-for=\"context in contexts\" :key=\"context.id\" class=\"shadow relative flex flex-col min-w-0 rounded p-4 bg-gray-100 dark:bg-gray-800 dark:text-gray-300\">\n            <div class=\"flex items-center justify-between mb-4\">\n              <h4 class=\"text-lg flex items-center\">\n                <WorkspaceIcon class=\"w-5\" />\n                <span class=\"ml-2\">{{ context.name }}</span>\n              </h4>\n              <button @click=\"discard(context)\" class=\"button-flat button-size-medium text-sm text-red-500 bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700\">\n                <TrashIcon class=\"w-5\" />\n                <span class=\"ml-2\">Discard</span>\n              </button>\n            </div>\n            <div class=\"flex items-center flex-wrap gap-4\">\n              <Tag v-for=\"tag in context.tags\" :key=\"tag\">{{ tag }}</Tag>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { TrashIcon, Square2StackIcon as WorkspaceIcon } from '@heroicons/vue/24/outline'\nimport { nanoid } from 'nanoid'\nimport CoreButton from '/components/CoreButton.vue'\nimport Tag from '/components/Tag.vue'\n\nimport {\n  SET_CONTEXT_TAGS,\n} from '/src/store/actions.js';\n\nimport {\n  ADD_CONTEXT,\n  REMOVE_CONTEXT,\n} from '/src/store/modules/contexts.js'\n\nexport default {\n  components: {\n    CoreButton,\n    Tag,\n    TrashIcon,\n    WorkspaceIcon,\n  },\n  data() {\n    return {\n      activeIndex: 0,\n      contextName: '',\n      input: '',\n    };\n  },\n  computed: {\n    availableTags() {\n      return this.$store.getters.allTags;\n    },\n    contexts() {\n      return this.$store.getters.sortedContexts\n    },\n    filtered() {\n      return this.availableTags.filter((tag) => {\n        return tag.startsWith(this.input.toLowerCase());\n      });\n    },\n    selected() {\n      return this.tags.sort();\n    },\n    tags() {\n      return this.$store.state.context.tags;\n    },\n  },\n  methods: {\n    discard(context) {\n      this.$store.commit(REMOVE_CONTEXT, context)\n    },\n    down() {\n      if (this.activeIndex < (this.filtered.length - 1)) {\n        this.activeIndex += 1;\n\n        this.scroll();\n      }\n    },\n    first() {\n      this.activeIndex = 0;\n\n      this.$refs.tagsContainer.scrollElement.scroll(0, 0);\n    },\n    focusInput() {\n      this.$refs.input.focus();\n    },\n    save() {\n      this.$store.commit(ADD_CONTEXT, {\n        id: nanoid(),\n        name: this.contextName,\n        tags: this.tags,\n      })\n\n      this.contextName = ''\n      this.$store.dispatch(SET_CONTEXT_TAGS, { context: { tags: [] } })\n    },\n    scroll() {\n      const tagsContainer = this.$refs.tagsContainer.scrollElement;\n      const tag = this.$refs.tags[this.activeIndex];\n\n      const scrolltop = tagsContainer.scrollTop;\n      const offsetheight = tagsContainer.offsetHeight;\n      const offsettop = tag.offsetTop;\n      const height = tag.offsetHeight;\n\n      if (((offsettop + height) - scrolltop) > offsetheight) {\n        // need to scroll down\n        const scrolloffset = (offsettop - offsetheight) + height;\n\n        tagsContainer.scroll(0, scrolloffset);\n      } else if (offsettop < scrolltop) {\n        // need to scroll up?\n        tagsContainer.scroll(0, offsettop);\n      }\n    },\n    selectTag(tag) {\n      this.activeIndex = this.filtered.findIndex(t => t === tag);\n\n      this.toggleTag();\n    },\n    isSelected(tag) {\n      return this.tags.includes(tag);\n    },\n    toggleTag() {\n      const tag = this.filtered[this.activeIndex];\n\n      if (tag) {\n        let tags = this.tags;\n\n        if (tags.includes(tag)) {\n          tags = tags.filter(t => t !== tag);\n        } else {\n          tags = tags.concat([tag]);\n        }\n\n        this.$store.dispatch(SET_CONTEXT_TAGS, {\n          context: {\n            tags,\n          }\n        });\n      }\n    },\n    up() {\n      if (this.activeIndex > 0) {\n        this.activeIndex -= 1;\n\n        this.scroll();\n      }\n    },\n  },\n  mounted() {\n    // todo use action\n    this.$store.state.context.editing = true;\n    this.focusInput();\n  },\n  beforeUnmount() {\n    this.$store.state.context.editing = false;\n  },\n};\n</script>\n\n<style scoped>\n.dropdown-menu {\n  float: none;\n  max-height: 20rem;\n  padding: 0;\n  position: relative;\n  z-index: auto;\n}\n\n.dropdown-item {\n  cursor: pointer;\n}\n\n.dropdown-item.selected:not(.active) {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n\n.dropdown-item:hover:not(.active) {\n  background-color: #3f3f3f;\n}\n\n.form-control {\n  border: none;\n  height: auto;\n}\n\n.key {\n  border: 1px solid;\n  border-radius: 0.125rem;\n  padding: 0 0.25rem;\n  text-transform: uppercase;\n}\n\n.label {\n  background-color: #557bab;\n  border: none;\n  padding: 0.25rem 0.75rem;\n}\n</style>\n"],"names":["Tag","TrashIcon","WorkspaceIcon","_createElementVNode","_openBlock","_createElementBlock","_createVNode","_Fragment","_renderList","_createBlock","_normalizeClass","_toDisplayString"],"mappings":"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"}