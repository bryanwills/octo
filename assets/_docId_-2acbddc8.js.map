{"version":3,"file":"_docId_-2acbddc8.js","sources":["../../pages/docs/[docId].vue"],"sourcesContent":["<template>\n  <Editor\n    ref=\"editable\"\n    :appearance=\"appearance\"\n    :doc=\"doc\"\n    :key=\"doc.id\"\n    :initialFocus=\"initialFocus\"\n    :initialSelections=\"initialSelections\"\n    :ro=\"ro\"\n    :settings=\"settings\"\n    @input=\"input\"\n  />\n</template>\n\n<script>\nimport { defineComponent, inject } from 'vue'\nimport { useStore } from 'vuex'\nimport Editor from '/components/Editor.vue'\nimport { setTitle } from '/src/common/title'\nimport Doc from '/src/models/doc'\nimport { EDIT_DOCUMENT } from '/src/store/actions'\n\nconst formatTags = (tags, delimiter = ', ') => {\n  return tags.map((tag) => `#${tag}`).join(delimiter)\n}\n\nexport default defineComponent({\n  components: {\n    Editor,\n  },\n  props: {\n    docId: String,\n    initialFocus: {\n      type: String,\n      default: () => 'any',\n      validator: (position) => ['any', 'start', 'end'].includes(position),\n    },\n    initialSelections: {\n      type: Array,\n    },\n    ro: {\n      default: false,\n      type: Boolean,\n    },\n  },\n  data() {\n    return {\n      editor: null,\n      placeholder: new Doc({ text: formatTags(this.$store.state.context.tags, ' ') }),\n    }\n  },\n  setup() {\n    const appearance = inject('appearance')\n    const store = useStore()\n    const settings = computed(() => store.state.settings.editor)\n\n    return {\n      appearance: appearance.value === 'october' ? 'dark' : appearance.value,\n      settings,\n    }\n  },\n  watch: {\n    tags: {\n      deep: true,\n      handler() {\n        this.updateTitle()\n      },\n    },\n    header() {\n      this.updateTitle()\n    },\n  },\n  computed: {\n    doc() {\n      return this.$store.getters.decrypted.find((doc) => doc.id === this.docId) || this.placeholder\n    },\n    tags() {\n      return this.doc.tags\n    },\n    header() {\n      return this.doc.headers[0]\n    },\n  },\n  methods: {\n    input(text) {\n      if (!this.ro) {\n        this.$store.commit(EDIT_DOCUMENT, new Doc({ ...this.doc, text }))\n\n        if (!this.docId) {\n          this.$router.replace({\n            path: `/docs/${this.doc.id}`,\n            query: {\n              p: true,\n            },\n          })\n        }\n      }\n    },\n    updateTitle() {\n      setTitle(this.header || formatTags(this.doc.tags))\n    },\n  },\n  async mounted() {\n    this.updateTitle()\n  },\n})\n</script>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAsBA,MAAA,aAAA,CAAA,MAAA,YAAA,SAAA;;AAEA;AAEA,MAAA,YAAA,gBAAA;AAAA;IAEI;AAAA;EAEF,OAAA;AAAA;;;MAII,SAAA,MAAA;AAAA,MACA,WAAA,CAAA,aAAA,CAAA,OAAA,SAAA,KAAA,EAAA,SAAA,QAAA;AAAA;IAEF,mBAAA;AAAA;;IAGA,IAAA;AAAA;;;;EAKF,OAAA;AACE,WAAA;AAAA;MAEE,aAAA,IAAA,IAAA,EAAA,MAAA,WAAA,KAAA,OAAA,MAAA,QAAA,MAAA,GAAA,EAAA,CAAA;AAAA,IACF;AAAA;EAEF,QAAA;AACE,UAAA,aAAA,OAAA,YAAA;AACA,UAAA,QAAA,SAAA;;AAGA,WAAA;AAAA,MACE,YAAA,WAAA,UAAA,YAAA,SAAA,WAAA;AAAA,MACA;AAAA,IACF;AAAA;EAEF,OAAA;AAAA;MAEI,MAAA;AAAA,MACA,UAAA;AACE,aAAA,YAAA;AAAA;;IAGJ,SAAA;AACE,WAAA,YAAA;AAAA;;EAGJ,UAAA;AAAA;AAEI,aAAA,KAAA,OAAA,QAAA,UAAA,KAAA,CAAA,QAAA,IAAA,OAAA,KAAA,KAAA,KAAA,KAAA;AAAA;IAEF,OAAA;AACE,aAAA,KAAA,IAAA;AAAA;IAEF,SAAA;;;;EAIF,SAAA;AAAA;;;AAKM,YAAA,CAAA,KAAA,OAAA;AACE,eAAA,QAAA,QAAA;AAAA;YAEE,OAAA;AAAA,cACE,GAAA;AAAA;;QAGN;AAAA,MACF;AAAA;;;;;EAMJ,MAAA,UAAA;AACE,SAAA,YAAA;AAAA;AAEJ,CAAA;;;;IAvGI,KAAA;AAAA,IACC,YAAA,KAAA;AAAA,IACA,KAAA,KAAA;AAAA;IAEA,cAAA,KAAA;AAAA,IACA,mBAAA,KAAA;AAAA,IACA,IAAA,KAAA;AAAA,IACA,UAAA,KAAA;AAAA,IACA,SAAA,KAAA;AAAA;;;"}