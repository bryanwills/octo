import{V as p,S as h,b as f,s as k,R as D,D as d}from"./Editor.06ef6fc5.js";import"./index.96bc23b6.js";import"./account.e36cfacf.js";const M=()=>({compare:t=>!1,destroy:()=>{},eq:t=>!1,estimatedHeight:-1,ignoreEvent:()=>!0,toDOM:()=>{const t=document.createElement("span");return t.innerHTML="&#x2022;",t.setAttribute("aria-hidden","true"),t},updateDOM:()=>!1}),x=t=>({compare:e=>e.isChecked===t,destroy:()=>{},eq:e=>e.isChecked===t,estimatedHeight:-1,ignoreEvent:()=>!1,isChecked:t,toDOM:()=>{const e=document.createElement("input");return e.setAttribute("aria-hidden","true"),e.className="ink-mde-task-toggle",e.type="checkbox",e.checked=t,e},updateDOM:()=>!1}),O=(t,e,s,c)=>Math.max(t,s)<=Math.min(e,c),l=(t,e,s)=>t.selection.ranges.some(c=>O(e,s,c.from,c.to)),b=(t,e)=>{const s=t.state.sliceDoc(e+2,e+5);return t.dispatch({changes:{from:e+2,to:e+5,insert:s==="[ ]"?"[x]":"[ ]"}}),!0},v=()=>{const t=()=>d.replace({widget:M()}),e=r=>d.replace({widget:x(r)}),s=r=>{const n=[];return k(r).iterate({enter:({type:a,from:i,to:o})=>{if(a.name==="ListMark"&&!l(r,i,o)){const u=r.sliceDoc(o+1,o+4);if(!["[ ]","[x]"].includes(u)){const m=r.sliceDoc(i,o);["-","*"].includes(m)&&n.push(t().range(i,o))}}if(a.name==="TaskMarker"&&!l(r,i-2,o)){const u=r.sliceDoc(i,o);n.push(e(u==="[x]").range(i-2,o))}}}),n.length>0?D.of(n):d.none},c=p.define(()=>({}),{eventHandlers:{mousedown:(r,n)=>{const a=r.target;if((a==null?void 0:a.nodeName)==="INPUT"&&a.classList.contains("ink-mde-task-toggle"))return b(n,n.posAtDOM(a))}}}),g=h.define({create(r){return s(r)},update(r,{state:n}){return s(n)},provide(r){return f.decorations.from(r)}});return[c,g]};export{v as lists};
