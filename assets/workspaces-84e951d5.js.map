{"version":3,"file":"workspaces-84e951d5.js","sources":["../../pages/workspaces.vue"],"sourcesContent":["<template>\n  <div class=\"container flex flex-col mx-auto p-4 md:px-16 md:py-8\">\n    <div>\n      <h2 class=\"text-2xl\">Workspaces</h2>\n      <p class=\"mt-1 text-gray-500\">\n        A Workspace allows you to focus on what's important now by filtering your docs down to just a handful of relevant tags.\n      </p>\n      <div class=\"mt-4\">\n        <label for=\"context-name\">Name it and save it (optional)</label>\n        <div class=\"flex items-center mt-2\">\n          <input v-model=\"contextName\" type=\"text\" class=\"form-text w-full shadow\" id=\"context-name\" placeholder=\"Give this Workspace a name...\">\n          <button @click=\"save\" :disabled=\"!(tags.length && contextName)\" class=\"button button-size-medium button-color-gray disabled:text-gray-900 ml-2\">Save</button>\n        </div>\n        <small class=\"text-gray-700 mt-1 hidden md:block\">You must add at least one tag and give the context a name in order to save it.</small>\n      </div>\n      <div class=\"mt-4\">\n        <label for=\"tags-search\">Choose some tags</label>\n        <input v-model=\"input\" @input=\"first\" @keydown.space.prevent=\"toggleTag\" @keydown.enter.exact=\"toggleTag\" @keydown.221.prevent=\"down\" @keydown.down.prevent=\"down\" @keydown.219.prevent=\"up\" @keydown.up.prevent=\"up\" ref=\"input\" type=\"text\" class=\"form-text w-full mt-2\" id=\"tag-search\" placeholder=\"Start typing to filter the list...\" autocomplete=\"off\">\n        <small class=\"text-gray-700 mt-1 hidden md:block\">Navigate the list below with <span class=\"key\">up</span> or <span class=\"key\">down</span> and toggle tags with <span class=\"key\">space</span> or <span class=\"key\">enter</span></small>\n      </div>\n      <CoreScrollable ref=\"tagsContainer\" class=\"border rounded mt-4 max-h-[20rem] bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-700\">\n        <div>\n          <div v-if=\"filtered.length\" class=\"flex flex-col gap-1 p-2\">\n            <CoreButton v-for=\"(tag, index) in filtered\" @click=\"selectTag(tag)\" :key=\"tag\" ref=\"tags\" class=\"flex justify-between cursor-pointer p-6 md:p-3 focus-within:ring\" :class=\"{ 'bg-gray-200 dark:bg-gray-700': isSelected(tag), 'bg-blue-300 dark:bg-blue-500': (index === activeIndex) }\">\n              <Tag>{{ tag }}</Tag>\n              <span v-if=\"isSelected(tag)\">selected</span>\n            </CoreButton>\n          </div>\n          <div v-else class=\"flex justify-between p-3\">No results...</div>\n        </div>\n      </CoreScrollable>\n      <div class=\"mt-4\">\n        <h3 class=\"text-xl mb-4\">Workspaces</h3>\n        <div class=\"grid gap-4 grid-cols-1 lg:grid-cols-2\">\n          <div v-for=\"context in contexts\" :key=\"context.id\" class=\"shadow relative flex flex-col min-w-0 rounded p-4 bg-gray-100 dark:bg-gray-800 dark:text-gray-300\">\n            <div class=\"flex items-center justify-between mb-4\">\n              <h4 class=\"text-lg flex items-center\">\n                <WorkspaceIcon class=\"w-5\" />\n                <span class=\"ml-2\">{{ context.name }}</span>\n              </h4>\n              <button @click=\"discard(context)\" class=\"button-flat button-size-medium text-sm text-red-500 bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700\">\n                <TrashIcon class=\"w-5\" />\n                <span class=\"ml-2\">Discard</span>\n              </button>\n            </div>\n            <div class=\"flex items-center flex-wrap gap-4\">\n              <Tag v-for=\"tag in context.tags\" :key=\"tag\">{{ tag }}</Tag>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { TrashIcon, Square2StackIcon as WorkspaceIcon } from '@heroicons/vue/24/outline'\nimport { nanoid } from 'nanoid'\nimport CoreButton from '/components/CoreButton.vue'\nimport Tag from '/components/Tag.vue'\n\nimport {\n  SET_CONTEXT_TAGS,\n} from '/src/store/actions.js';\n\nimport {\n  ADD_CONTEXT,\n  REMOVE_CONTEXT,\n} from '/src/store/modules/contexts.js'\n\nexport default {\n  components: {\n    CoreButton,\n    Tag,\n    TrashIcon,\n    WorkspaceIcon,\n  },\n  data() {\n    return {\n      activeIndex: 0,\n      contextName: '',\n      input: '',\n    };\n  },\n  computed: {\n    availableTags() {\n      return this.$store.getters.allTags;\n    },\n    contexts() {\n      return this.$store.getters.sortedContexts\n    },\n    filtered() {\n      return this.availableTags.filter((tag) => {\n        return tag.startsWith(this.input.toLowerCase());\n      });\n    },\n    selected() {\n      return this.tags.sort();\n    },\n    tags() {\n      return this.$store.state.context.tags;\n    },\n  },\n  methods: {\n    discard(context) {\n      this.$store.commit(REMOVE_CONTEXT, context)\n    },\n    down() {\n      if (this.activeIndex < (this.filtered.length - 1)) {\n        this.activeIndex += 1;\n\n        this.scroll();\n      }\n    },\n    first() {\n      this.activeIndex = 0;\n\n      this.$refs.tagsContainer.scrollElement.scroll(0, 0);\n    },\n    focusInput() {\n      this.$refs.input.focus();\n    },\n    save() {\n      this.$store.commit(ADD_CONTEXT, {\n        id: nanoid(),\n        name: this.contextName,\n        tags: this.tags,\n      })\n\n      this.contextName = ''\n      this.$store.dispatch(SET_CONTEXT_TAGS, { context: { tags: [] } })\n    },\n    scroll() {\n      const tagsContainer = this.$refs.tagsContainer.scrollElement;\n      const tag = this.$refs.tags[this.activeIndex];\n\n      const scrolltop = tagsContainer.scrollTop;\n      const offsetheight = tagsContainer.offsetHeight;\n      const offsettop = tag.offsetTop;\n      const height = tag.offsetHeight;\n\n      if (((offsettop + height) - scrolltop) > offsetheight) {\n        // need to scroll down\n        const scrolloffset = (offsettop - offsetheight) + height;\n\n        tagsContainer.scroll(0, scrolloffset);\n      } else if (offsettop < scrolltop) {\n        // need to scroll up?\n        tagsContainer.scroll(0, offsettop);\n      }\n    },\n    selectTag(tag) {\n      this.activeIndex = this.filtered.findIndex(t => t === tag);\n\n      this.toggleTag();\n    },\n    isSelected(tag) {\n      return this.tags.includes(tag);\n    },\n    toggleTag() {\n      const tag = this.filtered[this.activeIndex];\n\n      if (tag) {\n        let tags = this.tags;\n\n        if (tags.includes(tag)) {\n          tags = tags.filter(t => t !== tag);\n        } else {\n          tags = tags.concat([tag]);\n        }\n\n        this.$store.dispatch(SET_CONTEXT_TAGS, {\n          context: {\n            tags,\n          }\n        });\n      }\n    },\n    up() {\n      if (this.activeIndex > 0) {\n        this.activeIndex -= 1;\n\n        this.scroll();\n      }\n    },\n  },\n  mounted() {\n    // todo use action\n    this.$store.state.context.editing = true;\n    this.focusInput();\n  },\n  beforeUnmount() {\n    this.$store.state.context.editing = false;\n  },\n};\n</script>\n\n<style scoped>\n.dropdown-menu {\n  float: none;\n  max-height: 20rem;\n  padding: 0;\n  position: relative;\n  z-index: auto;\n}\n\n.dropdown-item {\n  cursor: pointer;\n}\n\n.dropdown-item.selected:not(.active) {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n\n.dropdown-item:hover:not(.active) {\n  background-color: #3f3f3f;\n}\n\n.form-control {\n  border: none;\n  height: auto;\n}\n\n.key {\n  border: 1px solid;\n  border-radius: 0.125rem;\n  padding: 0 0.25rem;\n  text-transform: uppercase;\n}\n\n.label {\n  background-color: #557bab;\n  border: none;\n  padding: 0.25rem 0.75rem;\n}\n</style>\n"],"names":["Tag","TrashIcon","_createElementVNode","_openBlock","_createElementBlock","_Fragment","_renderList","_toDisplayString"],"mappings":"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"}